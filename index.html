<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Operation: Get Active</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Bangers&family=Roboto:wght@400;700&display=swap');

        :root {
            --lazy-pink: #ff69b4;
            --lazy-orange: #ffa500;
            --storm-purple: #4b0082;
            --storm-light: #9370db;
            --fn-yellow: #fefe00;
            --fn-blue: #00bfff;
            --text-color: #ffffff;
            --bg-dark: #1a0b2e;
        }

        body {
            background: radial-gradient(circle at center, var(--storm-light), var(--bg-dark));
            font-family: 'Roboto', sans-serif;
            color: var(--text-color);
            margin: 0;
            padding: 0;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }

        #game-container {
            width: 90%;
            max-width: 800px;
            height: 90vh;
            background: rgba(0, 0, 0, 0.85);
            border: 4px solid var(--lazy-pink);
            border-radius: 15px;
            display: flex;
            flex-direction: column;
            box-shadow: 0 0 30px var(--storm-purple);
            position: relative;
        }

        /* HUD Styling */
        #hud {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.1);
            border-bottom: 2px solid var(--fn-blue);
        }

        .stat-box {
            background: rgba(0, 0, 0, 0.5);
            padding: 5px;
            text-align: center;
            border-radius: 5px;
            border: 1px solid var(--fn-blue);
        }

        .stat-label {
            font-family: 'Bangers', cursive;
            font-size: 1.2rem;
            color: var(--fn-yellow);
            letter-spacing: 1px;
            text-shadow: 1px 1px 0 #000;
        }

        .stat-val {
            font-weight: bold;
            font-size: 1.1rem;
        }

        /* Main Content Area */
        #main-display {
            flex-grow: 1;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
        }

        .log-entry {
            margin-bottom: 15px;
            padding: 10px;
            border-left: 4px solid var(--lazy-orange);
            background: rgba(255, 165, 0, 0.1);
            animation: fadeIn 0.5s ease;
        }

        .log-entry.system {
            border-left-color: var(--fn-blue);
            background: rgba(0, 191, 255, 0.1);
            font-style: italic;
        }

        .log-entry.bad {
            border-left-color: red;
            background: rgba(255, 0, 0, 0.1);
        }

        .log-entry.good {
            border-left-color: var(--fn-yellow);
            background: rgba(254, 254, 0, 0.1);
        }

        h2 {
            font-family: 'Bangers', cursive;
            color: var(--lazy-pink);
            font-size: 2rem;
            margin-top: 0;
            text-shadow: 2px 2px 0 var(--storm-purple);
        }

        /* Controls */
        #controls {
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            background: rgba(0, 0, 0, 0.9);
            border-top: 2px solid var(--fn-blue);
            border-radius: 0 0 12px 12px;
        }

        button {
            background: linear-gradient(45deg, var(--fn-blue), #0077be);
            border: none;
            color: white;
            padding: 15px;
            font-family: 'Bangers', cursive;
            font-size: 1.2rem;
            cursor: pointer;
            transform: skew(-10deg);
            transition: all 0.2s;
            border: 2px solid white;
            text-shadow: 1px 1px 0 #000;
        }

        button:hover {
            transform: skew(-10deg) scale(1.02);
            background: linear-gradient(45deg, var(--fn-yellow), #d4d400);
            color: black;
            text-shadow: none;
        }

        button:disabled {
            background: #555;
            cursor: not-allowed;
            opacity: 0.6;
            color: #ccc;
        }

        .relationship-tracker {
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 0.8rem;
            color: var(--lazy-pink);
            text-align: right;
            pointer-events: none;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #1a0b2e; 
        }
        ::-webkit-scrollbar-thumb {
            background: var(--lazy-pink); 
            border-radius: 4px;
        }
    </style>
</head>
<body>

<div id="game-container">
    <div class="relationship-tracker">
        Sportacus: <span id="rel-sport">0</span> | Stephanie: <span id="rel-steph">0</span>
    </div>

    <div id="hud">
        <div class="stat-box">
            <div class="stat-label">HYPE</div>
            <div class="stat-val" id="val-hype">20</div>
        </div>
        <div class="stat-box">
            <div class="stat-label">BUILD</div>
            <div class="stat-val" id="val-build">20</div>
        </div>
        <div class="stat-box">
            <div class="stat-label">TACTICS</div>
            <div class="stat-val" id="val-tactics">20</div>
        </div>
        <div class="stat-box" style="border-color: red;">
            <div class="stat-label" style="color: #ff6666;">ENERGY</div>
            <div class="stat-val" id="val-energy">20</div>
        </div>
    </div>

    <div id="main-display"></div>

    <div id="controls">
        <!-- Buttons generated by JS -->
    </div>
</div>

<script>
    // --- GAME STATE ---
    const state = {
        stats: {
            hype: 20,
            build: 20,
            tactics: 20,
            energy: 20
        },
        relationships: {
            sportacus: 0,
            stephanie: 0
        },
        difficulty: 'normal', // creative, normal, sweat
        diffMod: 0, // Stat threshold modifier
        penaltyMod: 1, // Damage multiplier
        gameOver: false
    };

    // --- DOM ELEMENTS ---
    const dom = {
        hype: document.getElementById('val-hype'),
        build: document.getElementById('val-build'),
        tactics: document.getElementById('val-tactics'),
        energy: document.getElementById('val-energy'),
        relSport: document.getElementById('rel-sport'),
        relSteph: document.getElementById('rel-steph'),
        display: document.getElementById('main-display'),
        controls: document.getElementById('controls')
    };

    // --- CORE LOGIC ---

    function log(text, type = 'normal') {
        const div = document.createElement('div');
        div.className = `log-entry ${type}`;
        div.innerHTML = text;
        dom.display.appendChild(div);
        dom.display.scrollTop = dom.display.scrollHeight;
    }

    function updateStats(hypeChange, buildChange, tacticsChange, energyChange) {
        // Apply multipliers based on Difficulty for negative values
        if (state.difficulty === 'creative' && energyChange < 0) energyChange = Math.floor(energyChange * 0.5);
        if (state.difficulty === 'sweat' && energyChange < 0) energyChange = Math.floor(energyChange * 1.5);

        // Apply
        state.stats.hype += hypeChange;
        state.stats.build += buildChange;
        state.stats.tactics += tacticsChange;
        state.stats.energy += energyChange;

        // Caps
        for (let key in state.stats) {
            if (state.stats[key] > 100) state.stats[key] = 100;
        }

        // Render
        dom.hype.innerText = state.stats.hype;
        dom.build.innerText = state.stats.build;
        dom.tactics.innerText = state.stats.tactics;
        dom.energy.innerText = state.stats.energy;

        // Check Death
        if (state.stats.energy <= 0) {
            triggerGameOver("You have run out of Energy and fallen asleep.");
            return false;
        }
        
        // Sweat Mode Death Condition
        if (state.difficulty === 'sweat') {
            if (state.stats.hype <= 0 || state.stats.build <= 0 || state.stats.tactics <= 0) {
                triggerGameOver("SWEAT MODE FAIL: A stat reached zero. You got boxed like a fish.");
                return false;
            }
        }

        return true;
    }

    function updateRel(char, amount) {
        state.relationships[char] += amount;
        if (state.relationships[char] > 10) state.relationships[char] = 10;
        document.getElementById(`rel-${char === 'sportacus' ? 'sport' : 'steph'}`).innerText = state.relationships[char];
    }

    function statCheck(statName, threshold) {
        const adjustedThreshold = threshold + state.diffMod;
        const roll = state.stats[statName];
        return roll >= adjustedThreshold;
    }

    function triggerGameOver(reason) {
        state.gameOver = true;
        dom.controls.innerHTML = '';
        log(`<h2>GAME OVER</h2><p>${reason}</p>`, 'bad');
        const btn = document.createElement('button');
        btn.innerText = "Return to Lobby (Restart)";
        btn.onclick = () => location.reload();
        dom.controls.appendChild(btn);
    }

    function createButtons(choices) {
        dom.controls.innerHTML = '';
        if (state.gameOver) return;

        choices.forEach(choice => {
            const btn = document.createElement('button');
            
            // Check visibility conditions
            if (choice.condition && !choice.condition()) {
                return; // Don't show this button
            }

            // Check disable conditions (visible but greyed out)
            if (choice.requirementText) {
                const reqMet = choice.check ? choice.check() : true;
                btn.innerHTML = `${choice.text} <br><small style='font-size:0.8rem'>(${choice.requirementText})</small>`;
                if (!reqMet) {
                    btn.disabled = true;
                }
            } else {
                btn.innerText = choice.text;
            }

            btn.onclick = () => {
                choice.action();
            };
            dom.controls.appendChild(btn);
        });
    }

    // --- SCENES ---

    const scenes = {
        start: () => {
            log(`<h2>Initialize Operation "Get Active"</h2>
            <p>Welcome to a glitched server. Select your difficulty.</p>`);
            
            createButtons([
                {
                    text: "Creative Mode (Easy)",
                    action: () => {
                        state.difficulty = 'creative';
                        state.diffMod = -10;
                        state.penaltyMod = 0.5;
                        log("Difficulty Set: Creative. Stat Checks -10. Damage 50%.", 'system');
                        scenes.intro();
                    }
                },
                {
                    text: "Battle Royale (Normal)",
                    action: () => {
                        state.difficulty = 'normal';
                        state.diffMod = 0;
                        state.penaltyMod = 1;
                        log("Difficulty Set: Battle Royale. Standard Rules.", 'system');
                        scenes.intro();
                    }
                },
                {
                    text: "Sweat Mode (Hard)",
                    action: () => {
                        state.difficulty = 'sweat';
                        state.diffMod = 10;
                        state.penaltyMod = 1.5;
                        log("Difficulty Set: Sweat Mode. Stat Checks +10. Any 0 Stat = Game Over.", 'system');
                        scenes.intro();
                    }
                }
            ]);
        },

        intro: () => {
            log(`<p>The Battle Bus honks, but the melody is 'Bing Bang'. You drop not onto an island, but into a neon-colored suburb surrounded by a purple Storm. Everyone is asleep... except you.</p>`);
            setTimeout(scenes.scene1, 1500);
        },

        scene1: () => {
            log(`<h2>Scene 1: The Drop</h2>
            <p>You are gliding down. You spot <strong>Sportacus</strong> hanging precariously from the crashed Airship lodged in a Clock Tower.</p>`);

            createButtons([
                {
                    text: "Land Safe & Loot (TACTICS)",
                    action: () => {
                        updateStats(0, 0, 10, 5);
                        log("You stick the landing. You find a stash of Apples (Sports Candy). +10 TACTICS, +5 ENERGY.", 'good');
                        scenes.scene2();
                    }
                },
                {
                    text: "Emote Mid-Air (HYPE)",
                    action: () => {
                        updateStats(15, 0, 0, -5);
                        updateRel('stephanie', 1);
                        log("You 'Floss' mid-air to generate updraft. Stephanie sees you from a window and cheers. +15 HYPE, -5 ENERGY, +1 Steph.", 'good');
                        scenes.scene2();
                    }
                },
                {
                    text: "Dive Bomb Save (BUILD)",
                    requirementText: `Requires ${25 + state.diffMod} BUILD`,
                    check: () => statCheck('build', 25),
                    action: () => {
                        if (statCheck('build', 25)) {
                            updateStats(0, 20, 0, 0);
                            updateRel('sportacus', 2);
                            log("You catch him! +20 BUILD, +2 Sportacus.", 'good');
                        } else {
                            updateStats(0, 0, 0, -15);
                            log("You crash into a billboard. Sportacus saves you. Embarrassing. -15 ENERGY.", 'bad');
                        }
                        if(!state.gameOver) scenes.scene2();
                    }
                }
            ]);
        },

        scene2: () => {
            log(`<h2>Scene 2: The Loot Phase</h2>
            <p>Sportacus explains Robbie Rotten has hacked the Storm. You encounter 'Sleepy Henchmen' (robots in pajamas) blocking the path to the lair.</p>`);

            createButtons([
                {
                    text: "Crank 90s (BUILD)",
                    requirementText: `Requires ${30 + state.diffMod} BUILD`,
                    check: () => true, // Player can always TRY, pass/fail is inside
                    action: () => {
                        if (statCheck('build', 30)) {
                            updateStats(0, 0, 10, 0);
                            log("You build a tower over them. Clean edits. +10 TACTICS.", 'good');
                        } else {
                            updateStats(0, -10, 0, -10);
                            log("Your tower collapses. You take fall damage. -10 BUILD, -10 ENERGY.", 'bad');
                        }
                        if(!state.gameOver) scenes.scene3();
                    }
                },
                {
                    text: "Dance Battle (HYPE)",
                    requirementText: `Requires ${30 + state.diffMod} HYPE`,
                    check: () => true,
                    action: () => {
                        if (statCheck('hype', 30)) {
                            updateStats(20, 0, 0, 0);
                            updateRel('stephanie', 2);
                            log("You out-dance the robots. Stephanie is impressed. +20 HYPE, +2 Steph.", 'good');
                        } else {
                            updateStats(-15, 0, 0, -10);
                            log("Your moves are cringe. They throw tomatoes. -15 HYPE, -10 ENERGY.", 'bad');
                        }
                        if(!state.gameOver) scenes.scene3();
                    }
                },
                {
                    text: "Hack Nap-Time (TACTICS)",
                    requirementText: "Risky Logic Puzzle",
                    check: () => true,
                    action: () => {
                        // Logic puzzle result based on current tactic stat vs fixed number
                        if (state.stats.tactics > 25) {
                            updateStats(0, 0, 20, 0);
                            log("You upload a lullaby virus. The robots sleep. +20 TACTICS.", 'good');
                        } else {
                            updateStats(0, 0, 0, -20);
                            log("Hack failed. Robots enter Tantrum Mode. -20 ENERGY.", 'bad');
                        }
                        if(!state.gameOver) scenes.scene3();
                    }
                }
            ]);
        },

        scene3: () => {
            // Storm Effect
            if(!updateStats(0, 0, 0, -2)) return; // -2 Energy drain immediately

            log(`<h2>Scene 3: The Storm Circle</h2>
            <p>You reach Robbieâ€™s Lair. He is piloting a giant Mech Suit made of recliner chairs. The Storm is shrinking! (-2 Energy).</p>`);

            createButtons([
                {
                    text: "Throw Sports Apple (TEAMWORK)",
                    requirementText: `Need Sportacus Rel > 3 & ${30 + state.diffMod} TACTICS`,
                    check: () => state.relationships.sportacus > 3 && statCheck('tactics', 30),
                    action: () => {
                        log(`<h2>VICTORY ROYALE!</h2>
                        <p>Sportacus eats the apple, powers up, and flips onto the mech to disable it. You acted as the perfect squad leader.</p>
                        <p style='color:gold'>ENDING: THE TRUE HERO</p>`, 'good');
                        scenes.endGame();
                    }
                },
                {
                    text: "Pump Shotgun / Build Fight (SOLO)",
                    requirementText: `Need ${50 + state.diffMod} BUILD`,
                    check: () => true,
                    action: () => {
                        if (statCheck('build', 50)) {
                            log(`<h2>VICTORY ROYALE!</h2>
                            <p>You box Robbie in, edit a window, and destroy the controls with a Noise Maker. Robbie cries.</p>
                            <p style='color:silver'>ENDING: SWEATY VICTORY</p>`, 'good');
                        } else {
                            triggerGameOver("You ran out of materials. Robbie blasts you with the Laziness Ray.");
                            return;
                        }
                        scenes.endGame();
                    }
                },
                {
                    text: "Diplomacy (HYPE)",
                    requirementText: `Need ${60 + state.diffMod} HYPE`,
                    check: () => true,
                    action: () => {
                        if (statCheck('hype', 60)) {
                            log(`<h2>VICTORY ROYALE!</h2>
                            <p>You convince Robbie that ruling the world is too much work. He agrees and goes to take a nap.</p>
                            <p style='color:pink'>ENDING: DIPLOMATIC VICTORY</p>`, 'good');
                        } else {
                            updateStats(0,0,0,-100); // Instant kill
                            triggerGameOver("Robbie laughs at you. 'I have automated everything!' He blasts you.");
                            return;
                        }
                        scenes.endGame();
                    }
                }
            ]);
        },

        endGame: () => {
            dom.controls.innerHTML = '';
            const btn = document.createElement('button');
            btn.innerText = "Play Again";
            btn.style.marginTop = "20px";
            btn.onclick = () => location.reload();
            dom.display.appendChild(btn);
            dom.display.scrollTop = dom.display.scrollHeight;
        }
    };

    // --- INIT ---
    scenes.start();

</script>
</body>
</html>